[07-29 00:46:15.28] Model:   gin1
[07-29 00:46:15.28] Problem: AP
[07-29 00:46:15.28] Device:  cuda
[07-29 00:46:15.28] Lr:      0.001
[07-29 00:46:15.28] Epochs:  100
[07-29 00:46:16.77] Training with 350000 samples, validating with 5484 samples
[07-29 00:46:16.78] Beginning training
[07-29 02:24:02.08] Train loss: 0.662, accuracy 0.532
[07-29 02:24:46.96] Valid loss: 0.663, accuracy 0.523
[07-29 02:24:46.96] Epoch 1
[07-29 03:20:53.67] Train loss: 0.559, accuracy 0.692
[07-29 03:21:37.73] Valid loss: 0.566, accuracy 0.695
[07-29 03:21:37.74]   best model so far
[07-29 03:21:37.74] Epoch 2
[07-29 04:17:51.77] Train loss: 0.477, accuracy 0.735
[07-29 04:18:35.50] Valid loss: 0.423, accuracy 0.771
[07-29 04:18:35.51]   best model so far
[07-29 04:18:35.51] Epoch 3
[07-29 05:14:51.10] Train loss: 0.434, accuracy 0.775
[07-29 05:15:34.98] Valid loss: 0.405, accuracy 0.793
[07-29 05:15:34.99]   best model so far
[07-29 05:15:34.99] Epoch 4
[07-29 06:11:52.73] Train loss: 0.427, accuracy 0.784
[07-29 06:12:37.01] Valid loss: 0.415, accuracy 0.778
[07-29 06:12:37.01] Epoch 5
[07-29 07:08:47.52] Train loss: 0.424, accuracy 0.787
[07-29 07:09:31.20] Valid loss: 0.397, accuracy 0.802
[07-29 07:09:31.21]   best model so far
[07-29 07:09:31.21] Epoch 6
[07-29 08:05:36.27] Train loss: 0.420, accuracy 0.789
[07-29 08:06:20.20] Valid loss: 0.401, accuracy 0.805
[07-29 08:06:20.20] Epoch 7
[07-29 09:02:25.52] Train loss: 0.426, accuracy 0.781
[07-29 09:03:09.28] Valid loss: 0.387, accuracy 0.809
[07-29 09:03:09.29]   best model so far
[07-29 09:03:09.29] Epoch 8
[07-29 09:59:14.93] Train loss: 0.421, accuracy 0.787
[07-29 09:59:58.77] Valid loss: 0.414, accuracy 0.782
[07-29 09:59:58.77] Epoch 9
[07-29 10:56:03.54] Train loss: 0.418, accuracy 0.790
[07-29 10:56:47.58] Valid loss: 0.391, accuracy 0.808
[07-29 10:56:47.58] Epoch 10
[07-29 11:53:00.46] Train loss: 0.413, accuracy 0.793
[07-29 11:53:44.15] Valid loss: 0.381, accuracy 0.811
[07-29 11:53:44.16]   best model so far
[07-29 11:53:44.16] Epoch 11
[07-29 12:49:41.63] Train loss: 0.411, accuracy 0.794
[07-29 12:50:25.64] Valid loss: 0.395, accuracy 0.806
[07-29 12:50:25.64] Epoch 12
[07-29 13:46:34.44] Train loss: 0.410, accuracy 0.795
[07-29 13:47:18.15] Valid loss: 0.385, accuracy 0.807
[07-29 13:47:18.15] Epoch 13
[07-29 14:43:25.23] Train loss: 0.409, accuracy 0.795
[07-29 14:44:09.08] Valid loss: 0.382, accuracy 0.808
[07-29 14:44:09.08] Epoch 14
[07-29 15:40:12.76] Train loss: 0.407, accuracy 0.796
[07-29 15:40:56.50] Valid loss: 0.386, accuracy 0.805
[07-29 15:40:56.50] Epoch 15
[07-29 16:37:10.43] Train loss: 0.407, accuracy 0.797
[07-29 16:37:54.51] Valid loss: 0.380, accuracy 0.810
[07-29 16:37:54.52]   best model so far
[07-29 16:37:54.52] Epoch 16
[07-29 17:34:07.02] Train loss: 0.406, accuracy 0.797
[07-29 17:34:51.02] Valid loss: 0.378, accuracy 0.812
[07-29 17:34:51.03]   best model so far
[07-29 17:34:51.03] Epoch 17
[07-29 18:31:03.31] Train loss: 0.405, accuracy 0.797
[07-29 18:31:47.50] Valid loss: 0.379, accuracy 0.817
[07-29 18:31:47.50] Epoch 18
[07-29 19:28:05.07] Train loss: 0.404, accuracy 0.798
[07-29 19:28:49.45] Valid loss: 0.380, accuracy 0.810
[07-29 19:28:49.45] Epoch 19
[07-29 20:25:13.60] Train loss: 0.404, accuracy 0.799
[07-29 20:25:57.95] Valid loss: 0.377, accuracy 0.809
[07-29 20:25:57.96]   best model so far
[07-29 20:25:57.96] Epoch 20
[07-29 21:22:22.49] Train loss: 0.404, accuracy 0.798
[07-29 21:23:06.52] Valid loss: 0.383, accuracy 0.811
[07-29 21:23:06.52] Epoch 21
[07-29 22:19:29.30] Train loss: 0.403, accuracy 0.798
[07-29 22:20:13.36] Valid loss: 0.377, accuracy 0.816
[07-29 22:20:13.36] Epoch 22
[07-29 23:16:35.93] Train loss: 0.403, accuracy 0.799
[07-29 23:17:20.04] Valid loss: 0.380, accuracy 0.809
[07-29 23:17:20.04] Epoch 23
[07-30 00:13:42.33] Train loss: 0.402, accuracy 0.799
[07-30 00:14:26.37] Valid loss: 0.374, accuracy 0.811
[07-30 00:14:26.38]   best model so far
[07-30 00:14:26.38] Epoch 24
[07-30 01:10:30.02] Train loss: 0.402, accuracy 0.799
[07-30 01:11:13.68] Valid loss: 0.370, accuracy 0.821
[07-30 01:11:13.69]   best model so far
[07-30 01:11:13.69] Epoch 25
[07-30 02:07:02.13] Train loss: 0.401, accuracy 0.800
[07-30 02:07:45.78] Valid loss: 0.377, accuracy 0.813
[07-30 02:07:45.78] Epoch 26
[07-30 03:03:32.04] Train loss: 0.401, accuracy 0.799
[07-30 03:04:15.58] Valid loss: 0.372, accuracy 0.820
[07-30 03:04:15.58] Epoch 27
[07-30 03:59:59.86] Train loss: 0.401, accuracy 0.799
[07-30 04:00:43.27] Valid loss: 0.374, accuracy 0.817
[07-30 04:00:43.27] Epoch 28
[07-30 04:56:25.47] Train loss: 0.401, accuracy 0.800
[07-30 04:57:08.77] Valid loss: 0.375, accuracy 0.818
[07-30 04:57:08.77] Epoch 29
[07-30 05:52:54.87] Train loss: 0.400, accuracy 0.800
[07-30 05:53:38.37] Valid loss: 0.376, accuracy 0.811
[07-30 05:53:38.37] Epoch 30
[07-30 06:49:25.34] Train loss: 0.400, accuracy 0.800
[07-30 06:50:08.90] Valid loss: 0.378, accuracy 0.810
[07-30 06:50:08.90] Epoch 31
[07-30 07:45:51.26] Train loss: 0.400, accuracy 0.800
[07-30 07:46:34.59] Valid loss: 0.374, accuracy 0.817
[07-30 07:46:34.59] Epoch 32
[07-30 08:42:16.11] Train loss: 0.399, accuracy 0.800
[07-30 08:42:59.69] Valid loss: 0.373, accuracy 0.812
[07-30 08:42:59.69]   8 epochs without improvement, decrease lr to 0.0002
[07-30 08:42:59.69] Epoch 33
[07-30 09:38:48.76] Train loss: 0.399, accuracy 0.800
[07-30 09:39:33.10] Valid loss: 0.371, accuracy 0.815
[07-30 09:39:33.10] Epoch 34
[07-30 10:35:19.76] Train loss: 0.394, accuracy 0.803
[07-30 10:36:02.70] Valid loss: 0.371, accuracy 0.816
[07-30 10:36:02.70] Epoch 35
[07-30 11:31:03.43] Train loss: 0.393, accuracy 0.803
[07-30 11:31:46.29] Valid loss: 0.370, accuracy 0.814
[07-30 11:31:46.29] Epoch 36
[07-30 12:26:47.64] Train loss: 0.392, accuracy 0.803
[07-30 12:27:30.73] Valid loss: 0.370, accuracy 0.811
[07-30 12:27:30.73] Epoch 37
[07-30 13:23:23.64] Train loss: 0.392, accuracy 0.804
[07-30 13:24:08.12] Valid loss: 0.366, accuracy 0.819
[07-30 13:24:08.13]   best model so far
[07-30 13:24:08.13] Epoch 38
[07-30 14:20:19.86] Train loss: 0.391, accuracy 0.803
[07-30 14:21:03.77] Valid loss: 0.368, accuracy 0.819
[07-30 14:21:03.77] Epoch 39
[07-30 15:17:11.28] Train loss: 0.392, accuracy 0.804
[07-30 15:17:55.22] Valid loss: 0.371, accuracy 0.818
[07-30 15:17:55.22] Epoch 40
[07-30 16:13:55.97] Train loss: 0.391, accuracy 0.804
[07-30 16:14:39.77] Valid loss: 0.366, accuracy 0.815
[07-30 16:14:39.77] Epoch 41
[07-30 17:10:44.43] Train loss: 0.391, accuracy 0.804
[07-30 17:11:28.38] Valid loss: 0.368, accuracy 0.820
[07-30 17:11:28.38] Epoch 42
[07-30 18:07:45.14] Train loss: 0.391, accuracy 0.804
[07-30 18:08:29.21] Valid loss: 0.367, accuracy 0.817
[07-30 18:08:29.21] Epoch 43
[07-30 19:04:36.09] Train loss: 0.391, accuracy 0.804
[07-30 19:05:20.04] Valid loss: 0.368, accuracy 0.816
[07-30 19:05:20.04] Epoch 44
[07-30 20:01:29.89] Train loss: 0.391, accuracy 0.804
[07-30 20:02:13.79] Valid loss: 0.370, accuracy 0.815
[07-30 20:02:13.79] Epoch 45
[07-30 20:58:25.44] Train loss: 0.391, accuracy 0.804
[07-30 20:59:09.48] Valid loss: 0.375, accuracy 0.816
[07-30 20:59:09.48]   8 epochs without improvement, decrease lr to 4e-05
[07-30 20:59:09.48] Epoch 46
[07-30 21:55:21.52] Train loss: 0.390, accuracy 0.804
[07-30 21:56:05.47] Valid loss: 0.367, accuracy 0.815
[07-30 21:56:05.47] Epoch 47
[07-30 22:52:18.42] Train loss: 0.390, accuracy 0.804
[07-30 22:53:02.60] Valid loss: 0.369, accuracy 0.818
[07-30 22:53:02.60] Epoch 48
[07-30 23:49:17.92] Train loss: 0.390, accuracy 0.805
[07-30 23:50:01.99] Valid loss: 0.369, accuracy 0.817
[07-30 23:50:01.99] Epoch 49
[07-31 00:46:22.40] Train loss: 0.390, accuracy 0.804
[07-31 00:47:06.31] Valid loss: 0.369, accuracy 0.815
[07-31 00:47:06.31] Epoch 50
[07-31 01:43:17.42] Train loss: 0.388, accuracy 0.805
[07-31 01:44:01.11] Valid loss: 0.364, accuracy 0.818
[07-31 01:44:01.12]   best model so far
[07-31 01:44:01.12] Epoch 51
[07-31 02:40:19.22] Train loss: 0.387, accuracy 0.805
[07-31 02:41:03.55] Valid loss: 0.367, accuracy 0.817
[07-31 02:41:03.55] Epoch 52
[07-31 03:37:23.99] Train loss: 0.388, accuracy 0.805
[07-31 03:38:07.98] Valid loss: 0.365, accuracy 0.819
[07-31 03:38:07.98] Epoch 53
[07-31 04:34:17.30] Train loss: 0.387, accuracy 0.806
[07-31 04:35:01.27] Valid loss: 0.366, accuracy 0.816
[07-31 04:35:01.27] Epoch 54
[07-31 05:31:10.38] Train loss: 0.387, accuracy 0.805
[07-31 05:31:54.52] Valid loss: 0.364, accuracy 0.821
[07-31 05:31:54.52] Epoch 55
[07-31 06:28:10.53] Train loss: 0.388, accuracy 0.806
[07-31 06:28:54.85] Valid loss: 0.367, accuracy 0.817
[07-31 06:28:54.85] Epoch 56
[07-31 07:25:21.31] Train loss: 0.387, accuracy 0.806
[07-31 07:26:05.57] Valid loss: 0.364, accuracy 0.817
[07-31 07:26:05.58]   best model so far
[07-31 07:26:05.58] Epoch 57
[07-31 08:22:14.88] Train loss: 0.388, accuracy 0.805
[07-31 08:22:58.64] Valid loss: 0.369, accuracy 0.819
[07-31 08:22:58.64] Epoch 58
[07-31 09:18:58.93] Train loss: 0.387, accuracy 0.805
[07-31 09:19:42.60] Valid loss: 0.367, accuracy 0.819
[07-31 09:19:42.60] Epoch 59
[07-31 10:15:41.90] Train loss: 0.387, accuracy 0.805
[07-31 10:16:25.68] Valid loss: 0.365, accuracy 0.818
[07-31 10:16:25.68] Epoch 60
[07-31 11:12:30.03] Train loss: 0.387, accuracy 0.805
[07-31 11:13:14.32] Valid loss: 0.367, accuracy 0.818
[07-31 11:13:14.32] Epoch 61
[07-31 12:09:33.83] Train loss: 0.387, accuracy 0.805
[07-31 12:10:17.89] Valid loss: 0.364, accuracy 0.817
[07-31 12:10:17.89] Epoch 62
[07-31 13:06:40.11] Train loss: 0.387, accuracy 0.806
[07-31 13:07:23.92] Valid loss: 0.366, accuracy 0.817
[07-31 13:07:23.92] Epoch 63
[07-31 14:03:17.97] Train loss: 0.388, accuracy 0.806
[07-31 14:04:02.24] Valid loss: 0.366, accuracy 0.819
[07-31 14:04:02.24] Epoch 64
[07-31 14:59:55.79] Train loss: 0.387, accuracy 0.806
[07-31 15:00:40.06] Valid loss: 0.365, accuracy 0.818
[07-31 15:00:40.06]   8 epochs without improvement, decrease lr to 8.000000000000001e-06
[07-31 15:00:40.06] Epoch 65
[07-31 15:56:47.51] Train loss: 0.387, accuracy 0.806
[07-31 15:57:31.59] Valid loss: 0.366, accuracy 0.818
[07-31 15:57:31.59] Epoch 66
[07-31 16:53:43.97] Train loss: 0.386, accuracy 0.806
[07-31 16:54:27.64] Valid loss: 0.369, accuracy 0.819
[07-31 16:54:27.64] Epoch 67
[07-31 17:50:30.99] Train loss: 0.386, accuracy 0.806
[07-31 17:51:14.85] Valid loss: 0.366, accuracy 0.818
[07-31 17:51:14.85] Epoch 68
[07-31 18:47:05.42] Train loss: 0.387, accuracy 0.806
[07-31 18:47:49.05] Valid loss: 0.367, accuracy 0.818
[07-31 18:47:49.05] Epoch 69
[07-31 19:43:40.77] Train loss: 0.386, accuracy 0.806
[07-31 19:44:24.88] Valid loss: 0.365, accuracy 0.819
[07-31 19:44:24.88] Epoch 70
[07-31 20:40:18.78] Train loss: 0.386, accuracy 0.806
[07-31 20:41:02.32] Valid loss: 0.365, accuracy 0.816
[07-31 20:41:02.32] Epoch 71
[07-31 21:36:57.73] Train loss: 0.386, accuracy 0.806
[07-31 21:37:41.34] Valid loss: 0.367, accuracy 0.816
[07-31 21:37:41.34] Epoch 72
[07-31 22:33:32.41] Train loss: 0.386, accuracy 0.806
[07-31 22:34:16.05] Valid loss: 0.364, accuracy 0.817
[07-31 22:34:16.05]   16 epochs without improvement, early stopping
[07-31 22:35:00.00] Valid loss: 0.366, accuracy 0.818
[07-31 22:35:00.00] Saving model as /data/yxwu/python-moiptimiser/src/zap_branch2learn_global_attention_gat_b/models/gin1/gin1_AP_0.7size.pkl
[07-31 22:35:00.00] End of training.


